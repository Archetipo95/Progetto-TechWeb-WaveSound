<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>WaveSound | Main Page</title>
	<!-- font + fav icon -->
	<link rel="icon" type="image/png" href="misc/img/logo.png">
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
	<!-- style -->
	<link rel="stylesheet" type="text/css" href="misc/css/style.css" /> </head>

<body>
	<header>
		<?php
			include("misc/include/header.html");
			$_SESSION["current-page"]="Listen";
		?>
	</header>
	<nav>
		<?php
			include("misc/include/navigation.html");
		?>
	</nav>
	<main class="main-right">
		<div class="content-body">
			<div class="content">
				<div class="content-play">
					<div class="content">
					
					
						<?php
							if(isset($_GET['id_song'])){
								$id_song = $_GET['id_song'];
								require ('misc/php/connection.php');
								require ('misc/php/tools.php');
								$statement=select("SELECT * FROM song WHERE id_song='$id_song'");
								$col = count($statement);
								/*if ($col == 1) {*/
									$row = $statement[0];
									//echo $row[0];/*id*/
									//echo $row[1];/*titolo*/
									//echo $row[2];/*genere*/
									//echo $row[3];/*descrizione*/
									//echo $row[4];/*path*/
									//echo $row[5];/*id-album*/
									//echo $row[6];/*upload date*/
								/*}*/
							}
						?>
						
						<h1><?php echo $row[1];?></h1>	
						
						<div class="center">
						<div id="player-audio">
							<div class="content-card-cover"></div>
								<audio controls>
									<?php echo '<source src="misc/songs/'.$row[4].'" type="audio/mpeg">';?> Your browser does not support the audio element.
								</audio>
							</div>
						</div>
						<form action="misc/php/rating.php" method="post">
							<input type="submit" value="Like" name="action">
							<input type="submit" value="Dislike" name="action">
							<input type="hidden" name="element" value="1">
							<!-- VALORE DI PROVA -->
						</form>
						
						<?php echo 'Description + data + autore TODO';?>
						
						<h3>Leave a comment</h3>
						<form action="misc/php/player.php" method="post">
							<div>
								<textarea rows="20" id="comment-area" type="text" name="yourComment" placeholder="Write your comment on this track"></textarea>
								<?php echo '<input type="hidden" value="'.$id_song.'" name="id_song">'; ?>
							</div>
							<div>
								<input type="submit" value="comment" name="comment">
							</div>
						</form>
					
						<?php
						
						$getComments=select("SELECT * FROM comment WHERE id_song='$id_song'");
						$num_comments = count($getComments);
						
						if($num_comments==1){
							echo "1 comment";
						}else{
							echo $num_comments." comments";
						}
							
						for($i=0; $i<$num_comments; $i++){
							$comment = $getComments[$i];
							$getUser=select("SELECT username FROM user WHERE u_id='$comment[2]'");
							
							echo '<div class="comment">';
							echo "<h3>".$getUser[0][0]."</h3>";
							echo '<h4>'.$comment[1].'</h4>';
							echo '</div>';
							
						}
						
						?>
						
					</div>
				</div><!--
				--><div class="content-suggestion center">
					<div class="content-card-container">
						<div class="content-card">
							<div class="content-card-cover"></div>
							<div class="content-card-cover"></div>
							<div class="content-card-cover"></div>
							<div class="content-card-cover"></div>
							<div class="content-card-cover"></div>
						</div>
					</div>
					</div>
			</div>
		</div>
	</main>
	<footer class="footer-main">
		<?php
			include("misc/include/footer.html");
		?>
	</footer>
	<button onclick="topFunction()" id="button-top" title="Go to top">Top</button>
	<script src="misc/js/button-top.js"></script>
</body>

</html>
